@model BuildInspect.Models.ViewModel.AssessmentFieldWindowWaterTightnessTestEntryViewModel
@using BuildInspect.Models.ViewModel
@{
    Layout = null;
    var RowCnt = 1;
    var modRowCnt = 1;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!-- Style CSS -->
    <style>
        .datepicker {
            z-index: 99999 !important;
        }

        #ui-datepicker-div {
            width: 30% !important;
        }

        .table-overflow-cont {
            overflow-x: scroll;
            width: 100%;
            overflow-y: visible;
            height: calc(100vh - 44px);
        }

        .min-w-200px {
            min-width: 200px;
        }

        .min-w-150px {
            min-width: 150px;
        }

        .min-w-50px {
            min-width: 50px;
        }
        /* table border css - start */

        table#Field-Window-Water-Tightness-Test-tbl {
            border-collapse: separate;
            border: none;
            border-spacing: 0;
        }

            table#Field-Window-Water-Tightness-Test-tbl tr td {
                padding: 5px;
                border-left: none;
                border-right: 1px solid #000000;
                border-top: none;
                border-bottom: 1px solid #000000;
            }

            table#Field-Window-Water-Tightness-Test-tbl thead tr:first-child td {
                border-top: 1px solid #000000;
            }

            table#Field-Window-Water-Tightness-Test-tbl tbody tr td.sticky-col-1:first-child,
            table#Field-Window-Water-Tightness-Test-tbl thead tr td:first-child,
            table#Field-Window-Water-Tightness-Test-tbl tfoot tr td:first-child {
                border-left: 1px solid #000000;
            }

            table#Field-Window-Water-Tightness-Test-tbl thead tr:first-child td:first-child {
                border-top-left-radius: 5px;
            }

            table#Field-Window-Water-Tightness-Test-tbl thead tr:first-child td:last-child {
                border-top-right-radius: 5px;
            }

            table#Field-Window-Water-Tightness-Test-tbl tfoot tr:last-child td:first-child {
                border-bottom-left-radius: 5px;
            }

            table#Field-Window-Water-Tightness-Test-tbl tfoot tr:last-child td:last-child {
                border-bottom-right-radius: 5px;
            }
        /* table border css - end */
        /* sticky table column - start */

        #Field-Window-Water-Tightness-Test-tbl .sticky-col-1,
        #Field-Window-Water-Tightness-Test-tbl .sticky-col-2,
        #Field-Window-Water-Tightness-Test-tbl .sticky-col-3,
        #Field-Window-Water-Tightness-Test-tbl .sticky-col-4 {
            position: sticky;
            z-index: 3;
            background-color: #ffffff;
        }

        #Field-Window-Water-Tightness-Test-tbl .sticky-col-1 {
            left: 0;
            text-align: center;
        }

        #Field-Window-Water-Tightness-Test-tbl .sticky-col-2 {
            left: 50px;
        }

        #Field-Window-Water-Tightness-Test-tbl .sticky-col-3 {
            left: calc(50px + 200px);
        }

        #Field-Window-Water-Tightness-Test-tbl .sticky-col-4 {
            left: calc(50px + 200px + 150px);
        }
        /* sticky table column - end */
        /* sticky table row - start */

        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-4 td,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td:first-child,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td:first-child,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td:first-child,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-4 td:first-child,
        #Field-Window-Water-Tightness-Test-tbl tfoot tr td:first-child,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td:nth-child(2),
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td:nth-child(2),
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td:nth-child(2),
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td:nth-child(3),
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td:nth-child(3),
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td:nth-child(3),
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-4 td:nth-child(2) {
            position: sticky;
            background-color: #ffffff;
        }

        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td,
        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-4 td {
            /*position: sticky;*/
            z-index: 10;
            /*background-color: #ffffff;*/
        }

            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td:first-child,
            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td:first-child,
            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td:first-child,
            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-4 td:first-child,
            #Field-Window-Water-Tightness-Test-tbl tfoot tr td:first-child {
                /*position: sticky;*/
                left: 0;
                z-index: 11;
                /*background-color: #ffffff;*/
            }

            /*#Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td:nth-child(2),*/
            /*#Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td:nth-child(2),*/
            /*#Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td:nth-child(2) {*/
            /*position: sticky;*/
            /*left: 50px;
            z-index: 11;*/
            /*background-color: #ffffff;*/
            /*}*/

            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td:nth-child(3),
            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td:nth-child(3),
            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td:nth-child(3),
            #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-4 td:nth-child(2) {
                /*position: sticky;*/
                left: 250px;
                z-index: 11;
                /*background-color: #ffffff;*/
            }

        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-1 td {
            top: 0;
        }

        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-2 td {
            top: 36px;
        }

        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-3 td {
            top: 71px;
        }

        #Field-Window-Water-Tightness-Test-tbl thead tr.sticky-row-4 td {
            top: 106px;
        }
        /* sticky table row - end */
        /* vertical text in td -start */

        .verticalTD td:not(:first-child) {
            height: 200px;
            max-width: 50px;
        }

        .verticalTD td span {
            display: block;
            white-space: nowrap;
            transform: rotate(-90deg) translatex(-75px);
        }
        /* vertical text in td -end */
        /* checkbox checkmark - start */

        .tdChechBox {
            min-width: 50px;
            position: relative;
            cursor: pointer;
        }

            .tdChechBox[aria-checked="null"]::before,
            .tdChechBox[aria-checked="null"]::after,
            .tdChechBox[aria-checked="true"]::after,
            .tdChechBox[aria-checked="false"]::before {
                display: none;
            }

            .tdChechBox[aria-checked="true"]::before {
                display: inline-block;
            }

            .tdChechBox[aria-checked="false"]::after {
                display: inline-block;
            }

            .tdChechBox i {
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .tdChechBox:focus {
                outline: none;
            }

            .tdChechBox::before,
            .tdChechBox::after {
                font-family: "Font Awesome 5 Free";
                font-weight: 900;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .tdChechBox::before {
                content: "\f00c";
                color: #28a745;
            }

            .tdChechBox::after {
                content: "\f00d";
                color: #dc3545;
            }

            .tdChechBox[disabled=""]::before,
            .tdChechBox[disabled=""]::after {
                color: #545b62;
            }

            .tdChechBox[disabled=""] {
                cursor: not-allowed;
            }
        /* checkbox checkmark - end */

        #Field-Window-Water-Tightness-Test-tbl .selected td {
            background-color: #d1dade;
        }

        .myModel {
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 11;
            background-color: rgba(0, 0, 0, 0.25);
            display: none;
        }

        .modelContent {
            background-color: #ffffff;
            max-width: 500px;
        }
    </style>
</head>
<body class="hold-transition">
    @using (Html.BeginForm(null, null, FormMethod.Post, new { id = "FieldWindowWaterTightnessTest_Form", @class = "form-horizontal", enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()
        @Html.HiddenFor(model => Model.assessmentFieldWindowWaterTightnessTestIndexViewModel.ProjectID, new { @id = "hdnForProjectID" })
        @Html.Hidden("HdnID")
        @Html.Hidden("HdnZoom", 100)
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <table id="Field-Window-Water-Tightness-Test-tbl" border="1">
                <tr class="text-center">
                    <td class="min-w-50px" style="border:none"></td>
                    <td class="min-w-200px text-right" style="border-left: 1px solid #000000;border-top: 1px solid #000000;">
                        Project :
                    </td>
                    <td colspan="3" class="text-left" style="border-top: 1px solid #000000;">
                        @Model.projectMasterView.Project_Name
                    </td>
                    <td rowspan="6" colspan="3" style="border:none" valign="middle" align="center" class="text-center">
                        <div class="logoContainrer">
                            <img src="~/images/logo.png" width="auto" height="75">
                        </div>
                    </td>
                </tr>
                <tr class="text-center">
                    <td class="min-w-50px" style="border:none"></td>
                    <td class="text-right" style="border-left: 1px solid #000000;">
                        Developer :
                    </td>
                    <td colspan="3" class="text-left">
                        @Model.projectMasterView.Developer_Name
                    </td>
                </tr>
                <tr>
                    <td class="min-w-50px" style="border:none"></td>
                    <td class="text-right" style="border-left: 1px solid #000000;">
                        Contractor :
                    </td>
                    <td colspan="3" class="text-left">
                        @Model.projectMasterView.Contractor_Name
                    </td>
                </tr>
                <tr>
                    <td class="min-w-50px" style="border:none"></td>
                    <td class="text-right" style="border-left: 1px solid #000000;">
                        Windows / External Wall Contractor :
                    </td>
                    <td colspan="3" class="text-left">
                        @Model.projectMasterView.FieldWindowWTT_Contractor_Name
                    </td>
                </tr>
                <tr>
                    <td class="min-w-50px" style="border:none"></td>
                    <td class="text-right" style="border-left: 1px solid #000000;">
                        Witness :
                    </td>
                    <td colspan="3" class="text-left">
                        @Model.projectMasterView.FieldWindowWTT_Witness_Name
                    </td>
                </tr>
                <tr>
                    <td class="min-w-50px" style="border:none"></td>
                    <td class="text-right" style="border-left: 1px solid #000000;">
                        Date of Assessment :
                    </td>
                    <td colspan="3" class="text-left">
                        @Model.projectMasterView.Assessment_Dates
                    </td>
                </tr>
                <tr class="text-left">
                    <td colspan="9" style="font-weight:bold;border:none">
                        <br />
                        <u>@ViewBag.Title</u>
                        <br />
                        <br />
                    </td>
                </tr>
            </table>
        
        <table id="Field-Window-Water-Tightness-Test-tbl">
            <thead>
                <tr class="text-center">
                    <td colspan="3" class="min-w-150px text-right">No. of compliance</td>
                    <td class="Complain text-info font-weight-bold">0</td>
                </tr>
                <tr class="text-center ">
                    <td colspan="3" class="text-right">No. of checks</td>
                    <td class="Check text-info font-weight-bold">0</td>
                </tr>
                <tr class="text-center">
                    <td colspan="3"></td>
                    <td style="min-width: 100px;" class="text-center">Field Window</td>
                </tr>
                <tr class="verticalTD">
                    <td colspan="2" style="min-width: 250px;"></td>
                    <td class="text-center" style="min-width: 200px;">
                        <h5>Assessors</h5>
                        @foreach (var item1 in Model.projectMasterView.assessment_project_assessors_detail)
                        {
                            @item1.assessors_master.AssessorsName;
                            <br />
                        }
                    </td>
                    <td class="text-center">Pass or Fail</td>
                </tr>
            </thead>

            @foreach (var trn in Model.assessmentFieldWindowWaterTightnessTestTransViewModels.OrderBy(x => x.AssessmentFWWTTID))
            {
                <tbody id="tbody_@trn.AssessmentFWWTTID">
                    <tr>
                        <td rowspan="7" class="sticky-col-1 min-w-50px" role="checkbox" aria-checked="false" id="rowId_@trn.AssessmentFWWTTID">@RowCnt</td>
                        <td class="sticky-col-2 min-w-200px" valign="top">Date (dd-mmm-yyyy)</td>
                        <td class="sticky-col-3 min-w-150px" valign="top">@string.Format("{0:dd-MMM-yyyy}", @trn.AssessmentDate)</td>
                        @if (Model.projectMasterView.Is_Completed == 1)
                        {
                            if (trn.Result == "1") // Tick
                            {
                                <td class="tdChechBox" role="checkbox" aria-checked="true" disabled id="FieldWindowWTT_@trn.AssessmentFWWTTID.ToString()"></td>
                            }
                            else if (trn.Result == "2") // Cross
                            {
                                <td class="tdChechBox" role="checkbox" aria-checked="false" disabled id="FieldWindowWTT_@trn.AssessmentFWWTTID.ToString()"></td>
                            }
                            else // Blank
                            {
                                <td class="tdChechBox" role="checkbox" aria-checked="null" disabled id="FieldWindowWTT_@trn.AssessmentFWWTTID.ToString()"></td>
                            }
                        }
                        else
                        {
                            if (trn.Result == "1") // Tick
                            {
                                <td class="tdChechBox" role="checkbox" aria-checked="true" id="FieldWindowWTT_@trn.AssessmentFWWTTID.ToString()"></td>
                            }
                            else if (trn.Result == "2") // Cross
                            {
                                <td class="tdChechBox" role="checkbox" aria-checked="false" id="FieldWindowWTT_@trn.AssessmentFWWTTID.ToString()"></td>
                            }
                            else // Blank
                            {
                                <td class="tdChechBox" role="checkbox" aria-checked="null" id="FieldWindowWTT_@trn.AssessmentFWWTTID.ToString()"></td>
                            }
                        }
                    </tr>
                    <tr>
                        <td class="sticky-col-2" valign="top">Block/Unit</td>
                        <td class="sticky-col-3" valign="top">@trn.Block_Unit</td>
                        <td rowspan="6" valign="top">
                            @if (!string.IsNullOrEmpty(trn.Drawing_Image))
                            {
                                <img src="@trn.Drawing_Image" height="50" id="img_@trn.AssessmentFWWTTID">
                            }
                        </td>
                    </tr>
                    <tr>
                        <td class="sticky-col-2" valign="top">Wall >></td>
                        <td class="sticky-col-3" valign="top">@trn.assessment_wall_master.AssessmentWallName</td>
                    </tr>
                    <tr>
                        <td class="sticky-col-2" valign="top">Window >></td>
                        <td class="sticky-col-3" valign="top">@trn.assessment_window_master.AssessmentWindowName</td>
                    </tr>
                    <tr>
                        <td class="sticky-col-2" valign="top">Joint >></td>
                        <td class="sticky-col-3" valign="top">@trn.assessment_joint_master.AssessmentJointName</td>
                    </tr>
                    <tr>
                        <td class="sticky-col-2" valign="top">Direction >></td>
                        <td class="sticky-col-3" valign="top">@trn.assessment_direction_master.AssessmentDirectionName</td>
                    </tr>
                    <tr>
                        <td class="sticky-col-2" valign="top">Leak Thru >></td>
                        <td class="sticky-col-3" valign="top">@trn.assessment_leak_master.AssessmentLeakName</td>
                    </tr>
                </tbody>
                {
                    RowCnt++;
                }
            }
            <tr class="text-success font-weight-bold text-center ">
                <td colspan="3" class="text-right">No. of Ticks</td>
                <td class="TickCount text-center"></td>
            </tr>
            <tr class="text-success font-weight-bold text-center ">
                <td colspan="3" class="text-right">No. of checks</td>
                <td class="CheckCount text-center"></td>
            </tr>
        </table>
    }

    <script src="~/Content/assets/js/jquery.min.js"></script>
    <script src="~/Content/assets/js/popper.min.js"></script>
    <script src="~/Content/assets/js/bootstrap.min.js"></script>
    <script>

        onLoadmoduleStatusCount();

        function onLoadmoduleStatusCount() {

            let module = document.querySelectorAll('[id^="FieldWindowWTT"]');
            let Complains = 0;
            let Checks = 0;
            let individualCompliance = 0;
            let individualCheck = 0;

            for (let i = 0; i < module.length; i++) {
                let checkBoxValue = module[i].getAttribute('aria-checked');
                if (checkBoxValue == 'true') {
                    Checks++;
                    Complains++;
                    individualCompliance++;
                    individualCheck++;
                }
                else if (checkBoxValue == 'false') {
                    Checks++;
                    individualCheck++;
                }
            }
            document.querySelector('.Complain').innerHTML = Complains;
            document.querySelector('.Check').innerHTML = Checks;
            document.querySelector('.TickCount').innerHTML = individualCompliance;
            document.querySelector('.CheckCount').innerHTML = individualCheck;
        }
    </script>
</body>
</html>